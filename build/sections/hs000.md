
- [Forward {.unnumbered}](#forward-unnumbered)
- [Abstract {.unnumbered}](#abstract-unnumbered)
- [Introduction {.unnumbered}](#introduction-unnumbered)
  - [Optical Imaging of Neural Activity](#optical-imaging-of-neural-activity)
  - [Procedures for Calcium Imaging](#procedures-for-calcium-imaging)
  - [Computer Software Environments for Image Processing](#computer-software-environments-for-image-processing)
  - [Computational Resources for Processing Large Data Sets](#computational-resources-for-processing-large-data-sets)
- [Project Prologue {#sec:project-prologue}](#project-prologue-secproject-prologue)
  - [Neuroscience Technology Development Background {#sec:neuroscience-technology-development-background}](#neuroscience-technology-development-background-secneuroscience-technology-development-background)
  - [Behavior Box {#sec:behavior-box}](#behavior-box-secbehavior-box)
    - [IR Touchscreen {#sec:ir-touchscreen}](#ir-touchscreen-secir-touchscreen)
    - [FrameSynx Toolbox {#sec:framesynx-toolbox}](#framesynx-toolbox-secframesynx-toolbox)
    - [Data File {#sec:data-file}](#data-file-secdata-file)
  - [Animal Tracking {#sec:animal-tracking}](#animal-tracking-secanimal-tracking)
    - [Using Computer Vision to track Position and Orientation {#sec:using-computer-vision-to-track-position-and-orientation}](#using-computer-vision-to-track-position-and-orientation-secusing-computer-vision-to-track-position-and-orientation)
  - [Spherical Treadmill & Virtual-Reality](#spherical-treadmill--virtual-reality)
    - [Treadmill contstruction](#treadmill-contstruction)
      - [Figure: {#spherical-treadmill}](#figure-spherical-treadmill)
    - [Water Delivery](#water-delivery)
      - [Figure: {#figure-water-delivery}](#figure-figure-water-delivery)
    - [Motion Sensors](#motion-sensors)
      - [Generic USB Computer Mouse with Minimal Linux](#generic-usb-computer-mouse-with-minimal-linux)
      - [Navigation Sensor Chip with Arduino](#navigation-sensor-chip-with-arduino)
      - [Figure: {#figure-motion-sensors}](#figure-figure-motion-sensors)
  - [Closed-Loop Diffuse Optogenetic Neuromodulation](#closed-loop-diffuse-optogenetic-neuromodulation)
    - [Background](#background)
    - [Project Plan](#project-plan)
      - [Design a novel adaptive neuromodulation platform for closed loop control of neural activities {#sec:f31-aim1}](#design-a-novel-adaptive-neuromodulation-platform-for-closed-loop-control-of-neural-activities-secf31-aim1)
      - [Implement a library of closed loop modulation protocols with machine-learning algorithms {#sec:f31-aim2}](#implement-a-library-of-closed-loop-modulation-protocols-with-machine-learning-algorithms-secf31-aim2)
      - [Systematically evaluate the neural circuit mechanisms underlying DBS therapeutic effect on PD {#sec:f31-aim3}](#systematically-evaluate-the-neural-circuit-mechanisms-underlying-dbs-therapeutic-effect-on-pd-secf31-aim3)
    - [Significance](#significance)
      - [Justification for This Approach](#justification-for-this-approach)
      - [Shortcomings](#shortcomings)
    - [Research Design and Methods](#research-design-and-methods)
      - [Neural Interface](#neural-interface)
      - [LEDs](#leds)
      - [Electrophysiology](#electrophysiology)
      - [Front-end Digitization](#front-end-digitization)
      - [Signal Filtering, LFP and MUA](#signal-filtering-lfp-and-mua)
      - [Input/Output](#inputoutput)
      - [Closed-loop State Estimation and Adaptive Neuromodulation](#closed-loop-state-estimation-and-adaptive-neuromodulation)
      - [Generation and Evaluation of Stimulus Paradigm](#generation-and-evaluation-of-stimulus-paradigm)
      - [Machine-Learning & Optimization](#machine-learning--optimization)
      - [Identification of Neural State](#identification-of-neural-state)
      - [Stimulus Sequence Generation](#stimulus-sequence-generation)
      - [Stimulus Optimization](#stimulus-optimization)
    - [Systematic evaluation of potential DBS targets and mechanisms in PD mouse model:](#systematic-evaluation-of-potential-dbs-targets-and-mechanisms-in-pd-mouse-model)
      - [Metrics of Behavior](#metrics-of-behavior)
- [Microscopy 1](#microscopy-1)
  - [Background: Brain Imaging and Microscopy in Neuroscience](#background-brain-imaging-and-microscopy-in-neuroscience)
  - [Fluorescent Proteins Background](#fluorescent-proteins-background)
    - [Fluorescence Microscope Types Background](#fluorescence-microscope-types-background)
    - [Widefield Microscope COnfiguration](#widefield-microscope-configuration)
    - [Filters](#filters)
    - [Lenses](#lenses)
    - [Excitation](#excitation)
    - [Emission](#emission)
    - [Emitted Light Collection and Image Formation (emission/collection)](#emitted-light-collection-and-image-formation-emissioncollection)
    - [Microscopy and Functional Imaging Two core innovations in available](#microscopy-and-functional-imaging-two-core-innovations-in-available)
  - [Brain Imaging Awake Animals](#brain-imaging-awake-animals)
  - [Brain Regions](#brain-regions)
  - [Analysis](#analysis)
  - [Cameras for Widefield Microscopy](#cameras-for-widefield-microscopy)
    - [Accelerated Sensor improvement](#accelerated-sensor-improvement)
      - [Sensor Size](#sensor-size)
      - [Read noise and Speed](#read-noise-and-speed)
      - [Interfaces: Connection](#interfaces-connection)
      - [Interfaces: Protocol](#interfaces-protocol)
  - [Computer Workstation](#computer-workstation)
    - [Part Selection and Assembly](#part-selection-and-assembly)
    - [Configuration](#configuration)
    - [Package Managment](#package-managment)
    - [Development Environment](#development-environment)
  - [Head-Fixation Apparatus for Mice](#head-fixation-apparatus-for-mice)
- [Pipeline overview](#pipeline-overview)
  - [phases](#phases)
    - [preprocessing](#preprocessing)
      - [time series analysis](#time-series-analysis)
      - [spatial signal deconvolution (unmixing)](#spatial-signal-deconvolution-unmixing)
    - [signal localization and extraction](#signal-localization-and-extraction)
    - [active signal analysis](#active-signal-analysis)
      - [independent cellular activity measures](#independent-cellular-activity-measures)
      - [network analysis](#network-analysis)
  - [Computing cost:](#computing-cost)
  - [Storage cost:](#storage-cost)
- [Image Processing](#image-processing)
- [Procedures for Calcium Imaging](#procedures-for-calcium-imaging-1)
- [Computer Software Environments for Image Processing](#computer-software-environments-for-image-processing-1)
- [Computational Resources for Processing Large Data Sets](#computational-resources-for-processing-large-data-sets-1)
- [Method and Approach](#method-and-approach)
- [Image Pre-processing: Contrast Enhancement and Motion Correction](#image-pre-processing-contrast-enhancement-and-motion-correction)
- [Region of Interest (ROI) identification & segmentation:](#region-of-interest-roi-identification--segmentation)
- [Region of Interest (ROI) merging:](#region-of-interest-roi-merging)
- [Visualization](#visualization)
- [Predicting Activation State & Assessing Network Activity](#predicting-activation-state--assessing-network-activity)
- [Parallel Processing](#parallel-processing)
- [Managing Continuity -->](#managing-continuity)
  - [Procedures for Calcium Imaging](#procedures-for-calcium-imaging-2)
    - [Computer Software Environments for Image Processing](#computer-software-environments-for-image-processing-2)
    - [Computational Resources for Processing Large Data Sets](#computational-resources-for-processing-large-data-sets-2)
  - [Methods and Approach](#methods-and-approach)
    - [Image Pre-processing: Contrast Enhancement and Motion Correction](#image-pre-processing-contrast-enhancement-and-motion-correction-1)
    - [Region of Interest (ROI) identification & segmentation](#region-of-interest-roi-identification--segmentation)
    - [Region of Interest (ROI) merging](#region-of-interest-roi-merging)
    - [Visualization](#visualization-1)
    - [Predicting Activation State & Assessing Network Activity](#predicting-activation-state--assessing-network-activity-1)
    - [Parallel Processing](#parallel-processing-1)
    - [Managing Continuity](#managing-continuity)
      - [Computing Power and Connectivity](#computing-power-and-connectivity)
      - [Image Processing](#image-processing-1)
      - [Motion Correction Two approaches to find displacement](#motion-correction-two-approaches-to-find-displacement)
      - [Spatially Homogeneous phase correlation](#spatially-homogeneous-phase-correlation)
      - [Image Enhancement](#image-enhancement)
      - [Feature Extraction](#feature-extraction)
      - [Acceleration and Optimization Procedures for Online Video Processing](#acceleration-and-optimization-procedures-for-online-video-processing)
      - [Incremental Update of Statistics](#incremental-update-of-statistics)
        - [central moments](#central-moments)
        - [Extract Features](#extract-features)
      - [Simple Processing on GPU](#simple-processing-on-gpu)
        - [Alternative Libraries](#alternative-libraries)
    - [Choice of Interface](#choice-of-interface)
      - [Procedural Framework: Pipes, Streams, & Graphs](#procedural-framework-pipes-streams--graphs)
        - [Concurrency: Parallel = Performance?](#concurrency-parallel--performance)
        - [Scheduling](#scheduling)
        - [Adaptive](#adaptive)
      - [Choice of Operations](#choice-of-operations)
      - [Motion Correction](#motion-correction)
        - [Motion Compensation & Interpolation](#motion-compensation--interpolation)
- [Microscopy 2](#microscopy-2)
  - [Construction](#construction)
    - [Standards](#standards)
  - [Multispectral Imaging](#multispectral-imaging)
    - [Filter Selection](#filter-selection)
    - [Lenses](#lenses-1)
    - [Mechanics and Positioning](#mechanics-and-positioning)
  - [Electronics](#electronics)
    - [Photosensors](#photosensors)
  - [Cameras](#cameras)
    - [Scientific CMOS (sCMOS)](#scientific-cmos-scmos)
    - [Data-Transfer (Camera Interfaces)](#data-transfer-camera-interfaces)
  - [Image Acquisition](#image-acquisition)
  - [Image Data Management](#image-data-management)
  - [Sensors](#sensors)
- [Abstract](#abstract)
- [Introduction](#introduction)
- [Results](#results)
  - [Cranial Window **[System]{.smallcaps}**](#cranial-window-systemsmallcaps)
    - [Headplate](#headplate)
    - [Chamber](#chamber)
    - [Optical Insert](#optical-insert)
  - [Installation and Usage](#installation-and-usage)
  - [Evaluation of System Performance](#evaluation-of-system-performance)
    - [Experimental Batches](#experimental-batches)
    - [Sustained Optical Quality Extended over a Year](#sustained-optical-quality-extended-over-a-year)
    - [Direct Observation of Cranial Chamber](#direct-observation-of-cranial-chamber)
    - [In vivo Tracking of Transplanted Stem Cells over Long Term](#in-vivo-tracking-of-transplanted-stem-cells-over-long-term)
  - [Adaptability](#adaptability)
- [Discussion](#discussion)
- [Materials and Methods](#materials-and-methods)
  - [Device development and fabrication](#device-development-and-fabrication)
  - [Window casting procedure](#window-casting-procedure)
  - [Surgical procedures](#surgical-procedures)
  - [Headplate installation and craniotomy](#headplate-installation-and-craniotomy)
  - [Optical insert attachment](#optical-insert-attachment)
  - [Window detachment and replacement](#window-detachment-and-replacement)
  - [Injection](#injection)
  - [Wide-field in vivo imaging and microscope setup](#wide-field-in-vivo-imaging-and-microscope-setup)
  - [Figure 1 Design, assembly and installation of the polymeric optical window.](#figure-1-design-assembly-and-installation-of-the-polymeric-optical-window)
  - [Figure 2 Flexible experimental timeline for surgery, injection and imaging.](#figure-2-flexible-experimental-timeline-for-surgery-injection-and-imaging)
  - [Figure 3 Extended optical clarity by biocompatible design of the system.](#figure-3-extended-optical-clarity-by-biocompatible-design-of-the-system)
- [Video Processing](#video-processing)
  - [Continuous Online Video Processing](#continuous-online-video-processing)
  - [Introduction](#introduction-1)
  - [Method and Approach](#method-and-approach-1)
    - [Benchmarking & General Performance](#benchmarking--general-performance)
    - [Buffered Operations](#buffered-operations)
    - [Image Pre-Processing & Motion Correction](#image-pre-processing--motion-correction)
    - [Sequential Statistics](#sequential-statistics)
    - [Non-Stationarity & Differential Moments](#non-stationarity--differential-moments)
    - [Surface Classification: Peaks, Edges, Curvature](#surface-classification-peaks-edges-curvature)
    - [Online Cell Segmentation & Tracking](#online-cell-segmentation--tracking)
    - [Signal Extraction from Subcellular Compartments](#signal-extraction-from-subcellular-compartments)
    - [User Interface for Parameter Tuning](#user-interface-for-parameter-tuning)
  - [Compression: as a Tool, a Goal, as an Explanation](#compression-as-a-tool-a-goal-as-an-explanation)
  - [Data Management](#data-management)
  - [Data Scaling](#data-scaling)
  - [Distributed Dataflow and Streaming](#distributed-dataflow-and-streaming)
    - [Language: Is MATLAB the best tool for this job?](#language-is-matlab-the-best-tool-for-this-job)
    - [Alternatives Languages](#alternatives-languages)
    - [Databases](#databases)
    - [Big Data](#big-data)
    - [Computational Models](#computational-models)
- [Information and Informativity](#information-and-informativity)
- [Discussion](#discussion-1)
  - [Points to Address](#points-to-address)

